From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: SoSeDiK <mrsosedik@gmail.com>
Date: Tue, 10 Jan 2023 00:40:34 +0200
Subject: [PATCH] Expand Pose API


diff --git a/src/main/java/net/minecraft/world/entity/Entity.java b/src/main/java/net/minecraft/world/entity/Entity.java
index 7e2754b2c0b4ef6ca856b44c49139ec62c0c4c15..77b8c83a6cc79f24d2efc9efd234041a6345e361 100644
--- a/src/main/java/net/minecraft/world/entity/Entity.java
+++ b/src/main/java/net/minecraft/world/entity/Entity.java
@@ -400,6 +400,7 @@ public abstract class Entity implements Nameable, EntityAccess, CommandSource {
     public boolean freezeLocked = false; // Paper - Freeze Tick Lock API
     public boolean collidingWithWorldBorder; // Paper
     public @Nullable Boolean immuneToFire = null; // Purpur - Fire immune API
+    public boolean fixedPose = false; // Kiterino
 
     public void setOrigin(@javax.annotation.Nonnull Location location) {
         this.origin = location.toVector();
@@ -703,6 +704,11 @@ public abstract class Entity implements Nameable, EntityAccess, CommandSource {
     public void onClientRemoval() {}
 
     public void setPose(net.minecraft.world.entity.Pose pose) {
+        // Kiterino start
+        if (fixedPose) {
+            return;
+        }
+        // Kiterino end
         // CraftBukkit start
         if (pose == this.getPose()) {
             return;
diff --git a/src/main/java/org/bukkit/craftbukkit/entity/CraftEntity.java b/src/main/java/org/bukkit/craftbukkit/entity/CraftEntity.java
index e09787c851c4da39877b1cab51df7ead019b16de..c18a7394d218a6e6e93e5c143bce1252cb49f653 100644
--- a/src/main/java/org/bukkit/craftbukkit/entity/CraftEntity.java
+++ b/src/main/java/org/bukkit/craftbukkit/entity/CraftEntity.java
@@ -1503,5 +1503,18 @@ public abstract class CraftEntity implements org.bukkit.entity.Entity {
     public UUID getSpawningPlayerUuid() {
         return getHandle().spawningPlayerUuid;
     }
+
+    @Override
+    public void setPose(Pose pose, boolean fixed) {
+        Preconditions.checkNotNull(pose, "Pose cannot be null");
+        getHandle().fixedPose = false;
+        getHandle().setPose(net.minecraft.world.entity.Pose.values()[pose.ordinal()]);
+        getHandle().fixedPose = fixed;
+    }
+
+    @Override
+    public boolean hasFixedPose() {
+        return getHandle().fixedPose;
+    }
     // Kiterino end
 }
