From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: SoSeDiK <mrsosedik@gmail.com>
Date: Sat, 30 Jan 2021 18:55:38 +0200
Subject: [PATCH] Allow modifying vanilla block drops


diff --git a/src/main/java/org/bukkit/craftbukkit/event/CraftEventFactory.java b/src/main/java/org/bukkit/craftbukkit/event/CraftEventFactory.java
index b30d0d4d453252d1f5774f5155fb1ab61294d6be..bda2980a79cd2e174ec9cee061c2eedb09aab1b3 100644
--- a/src/main/java/org/bukkit/craftbukkit/event/CraftEventFactory.java
+++ b/src/main/java/org/bukkit/craftbukkit/event/CraftEventFactory.java
@@ -460,6 +460,21 @@ public class CraftEventFactory {
         Bukkit.getPluginManager().callEvent(event);
 
         if (!event.isCancelled()) {
+            // Kiterino start
+            if (event.changeDrops()) {
+                for (Item bukkit : list) {
+                    if (bukkit.isValid()) {
+                        bukkit.remove();
+                    }
+                }
+                org.bukkit.World world = block.getWorld();
+                org.bukkit.Location loc = block.getLocation();
+                for (org.bukkit.inventory.ItemStack drop : event.getDrops()) {
+                    world.dropItemNaturally(loc, drop);
+                }
+                return;
+            }
+            // Kiterino end
             // Paper start - Allow adding items to BlockDropItemEvent
             for (Item bukkit : list) {
                 if (!bukkit.isValid()) {
