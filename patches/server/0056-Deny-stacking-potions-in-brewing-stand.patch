From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: SoSeDiK <mrsosedik@gmail.com>
Date: Sun, 26 Dec 2021 19:08:38 +0200
Subject: [PATCH] Deny stacking potions in brewing stand


diff --git a/src/main/java/net/minecraft/world/inventory/AbstractContainerMenu.java b/src/main/java/net/minecraft/world/inventory/AbstractContainerMenu.java
index cb62866a069eaa2820fe040d63375c1627d58818..7f4fbf4efc9b75c263c6776b2a92d0e49f6776a3 100644
--- a/src/main/java/net/minecraft/world/inventory/AbstractContainerMenu.java
+++ b/src/main/java/net/minecraft/world/inventory/AbstractContainerMenu.java
@@ -775,6 +775,11 @@ public abstract class AbstractContainerMenu {
         return this.moveItemStackTo(stack, startIndex, endIndex, fromLast, false);
     }
     protected boolean moveItemStackTo(ItemStack stack, int startIndex, int endIndex, boolean fromLast, boolean isCheck) {
+        // Kiterino start
+        return this.moveItemStackTo(stack, startIndex, endIndex, fromLast, isCheck, false);
+    }
+    protected boolean moveItemStackTo(ItemStack stack, int startIndex, int endIndex, boolean fromLast, boolean isCheck, boolean ignoreStacks) { // Kiterino - add ignoreStacks
+        // Kiterino end
         if (isCheck) {
             stack = stack.copy();
         }
@@ -789,7 +794,7 @@ public abstract class AbstractContainerMenu {
         Slot slot;
         ItemStack itemstack1;
 
-        if (stack.isStackable()) {
+        if (stack.isStackable() && !ignoreStacks) { // Kiterino
             while (!stack.isEmpty()) {
                 if (fromLast) {
                     if (k < startIndex) {
diff --git a/src/main/java/net/minecraft/world/inventory/BrewingStandMenu.java b/src/main/java/net/minecraft/world/inventory/BrewingStandMenu.java
index e149d3d6637a321903866d22f77cdd9e459ccf5c..a398554a1c944ae9adb8722fa1412d7d90a48614 100644
--- a/src/main/java/net/minecraft/world/inventory/BrewingStandMenu.java
+++ b/src/main/java/net/minecraft/world/inventory/BrewingStandMenu.java
@@ -93,8 +93,8 @@ public class BrewingStandMenu extends AbstractContainerMenu {
                     if (!this.moveItemStackTo(itemstack1, 3, 4, false)) {
                         return ItemStack.EMPTY;
                     }
-                } else if (BrewingStandMenu.PotionSlot.mayPlaceItem(itemstack) && itemstack.getCount() == 1) {
-                    if (!this.moveItemStackTo(itemstack1, 0, 3, false)) {
+                } else if (BrewingStandMenu.PotionSlot.mayPlaceItem(itemstack)/* && itemstack.getCount() == 1*/) {
+                    if (!this.moveItemStackTo(itemstack1, 0, 3, false, false, true)) { // Kiterino - Move only one potion
                         return ItemStack.EMPTY;
                     }
                 } else if (slot >= 5 && slot < 32) {
